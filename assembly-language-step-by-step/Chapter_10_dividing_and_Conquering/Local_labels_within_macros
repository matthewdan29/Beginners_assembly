There is, however an importantn problem with labels used inside macros: labels in assembly language programs must be unique, and yet a macro is essentially duplicated in the source code as many times as it is invoked. 
This means there will be error messsagees flagging duplicated labels ... unless a macro's labels are treated as local. 
Local items have no meaning outside the immediate framework within which they are defined. 
Labels local to a macro are not visible outsid ethe macro definition, meaning that they cannot be referenced except from code within the '%MACRO...%ENDMACRO' bounds. 

All labels defined within a macro are considered local to the macro and are handled specially by the assembler. 
Example is a macro adaptation of a piece of code presented earlier, for forcing characters in a buffer from lowercase to uppercase: 

	%macro UpCase 2			; %1 = Address of buffer; %2 = Chars in buffer
		mov edx, %1		; Place the offset of the buffer into edx
		mov ecx, %2		; Place the number of bytes in the buffer into ecx
	%%IsLC: cmp byte [edx+ecx-1], 'a'	; Below 'a'?
		jb %%Bump 		; Not lowercase. Skip 
		cmp bute [edx+ecx-1], 'z'	; Not lowercase. skip
		sub byte [edx+ecx-1], 20h	; Force byte in buffer to uppercase
		%%Bump: dec ecx		; Decrement character count
			jnz %%IsLC	; If there are more chars in the buffer, repeat
	%endmacro

A label in a macro is made local by begining it with two percent symbols: %% (This is important)
When marking a location in the macro, the local label should be followed by a colon. 
When used as an operand to jump or call instruction (such as 'JA', 'JB', and 'JNZ' in the preceding), the local label is not followed by a colon. 
The important thing is to understand that unless the labels 'IsLC' and 'Bump' were made local to the macro by adding the prefix %% to each, there would be multiple instances of a label in the program (assuming the macro were invoked more than once) and the assembler would genereate a duplicate label error on the second and every subsequent invocation. 
Because labels must infact be unique within your program, NASM takes a macro local label such as "%%Bump" and genreates a label from it that will be unique in your program. 
It does this by using the prefix "...@" plus a four-digit number and the name of the label. 
Each time your macro is invoked, NASM will change the number, and thus generate unique synonyms for each local label within the macro. 
The label "%%Bump" for example might become ..@1771.Bump for a given invocation, and the number would be defferent each time the macro is invoked. 
This happens behind the scenes and you will rarely be aware that it's going on unless you read the code dump (lol I know right) listing files generated by NASM  
